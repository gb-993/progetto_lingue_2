{% extends "base.html" %}
{% block title %}Table A{% endblock %}
{% block breadcrumb %}Table A{% endblock %}

{% block content %}
  <div class="toolbar" role="region" aria-label="Azioni tabella">
    <form method="get" class="filters-form" aria-label="Filters">
      <label for="family" class="visually-hidden">Top level family</label>
      <select id="family" name="family">
        <option value="">All families</option>
        {% for fam in families %}
          <option value="{{ fam }}" {% if fam == selected_family %}selected{% endif %}>{{ fam|default:"(empty)" }}</option>
        {% endfor %}
      </select>

      <label for="historical" class="visually-hidden">Historical</label>
      <select id="historical" name="historical">
        <option value="all" {% if selected_historical == "all" %}selected{% endif %}>All</option>
        <option value="yes" {% if selected_historical == "yes" %}selected{% endif %}>Historical languages only</option>
        <option value="no"  {% if selected_historical == "no"  %}selected{% endif %}>Non-historical languages only</option>
      </select>

      <button class="btn" type="submit">Apply</button>
      {% if selected_family or selected_historical != "all" %}
        <a class="btn" href="{% url 'tablea_index' %}">Reset</a>
      {% endif %}
    </form>

    <div class="row-actions">
      <a class="btn" href="{% url 'tablea_export_xlsx' %}">Export .xlsx</a>
      <a class="btn" href="{% url 'tablea_export_csv' %}">Export .csv</a>
    </div>
  </div>

  <div class="card table-container">
    {% if rows %}
      <div class="table-scroll" role="region"
          aria-label="Table A – scroll horizontally to see all languages"
          tabindex="0">
        <table class="table table--freeze" aria-describedby="tablea-desc">
          <colgroup>
            <col class="w-label" />
            <col class="w-name" />
            <col /> <!-- Implication -->
          </colgroup>
          <!-- <caption id="tablea-desc">
            Valori per parametro (righe) e lingua (colonne).
          </caption> -->

          <thead>
            <tr>
              <th scope="col" class="col-sticky-left">Label</th>
              {# ⚠️ RIMOSSA sticky dalla colonna Name #}
              <th scope="col">Name</th>
              <th scope="col">Implication</th>
              {% for lang in languages %}
                <th scope="col">{{ lang.id }}</th>
              {% empty %}
                <th scope="col">No languages</th>
              {% endfor %}
            </tr>
          </thead>

          <tbody>
            {% for row in rows %}
              <tr>
                <th scope="row" class="col-sticky-left">{{ row.p.id }}</th>
                {# ⚠️ RIMOSSA sticky dalla cella Name #}
                <td>{{ row.p.name }}</td>
                <td class="muted">{{ row.p.implicational_condition }}</td>

                {% for val in row.cells %}
                  <td>{{ val }}</td>
                {% empty %}
                  <td>—</td>
                {% endfor %}
              </tr>
            {% empty %}
              <tr>
                <td colspan="{{ languages|length|add:3 }}">
                  Nessun dato disponibile per Table A.
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p role="status">Nessun dato disponibile per Table A.</p>
    {% endif %}
  </div>
{% endblock %}
