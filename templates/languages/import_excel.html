{% extends "base.html" %}

{% block title %}Import language data from Excel{% endblock %}
{% block breadcrumb %}Languages / Import from Excel{% endblock %}

{% block content %}
  <div class="card">
    <h2 class="h3">Import language data from Excel</h2>

    {# Stato 1: import appena AVVIATO in background #}
    {% if import_started %}
      <p class="muted">
        The file
        <strong>{{ uploaded_filename }}</strong>
        has been queued for import and is now being processed in the background.
      </p>

      <p>
        You can safely leave this page.<br>
        After some time, go back to the
        <a href="{% url 'language_list' %}">Languages list</a>
        and reload it: if the file was valid, the imported language data will be available.
      </p>

      <p class="muted">
        For large files or slow servers this may take several minutes.
        If something looks wrong, contact the administrator and check the server logs.
      </p>

      <div class="actions">
        <a href="{% url 'language_list' %}" class="btn">
          Back to Languages list
        </a>
        <a href="{% url 'language_import_excel' %}" class="btn secondary">
          Import another file
        </a>
      </div>

    {# Stato 2: GET iniziale, mostra form di upload #}
    {% else %}
      <p class="muted">
        Select an Excel file (.xlsx) containing language data.
        The import will use the same rules as the existing
        <code>import_language_from_excel</code> command.
      </p>

      <p class="muted">
        Once you start the import, the file will be processed in the background.
        You will see a confirmation message and you can then return to the
        Languages list and reload it later to see the results.
      </p>

      <form method="post" enctype="multipart/form-data" novalidate>
        {% csrf_token %}

        <div class="form-row">
          <label for="id_file">Excel file</label>
          <input type="file"
                 id="id_file"
                 name="file"
                 accept=".xlsx,.xlsm,.xltx,.xltm"
                 required>
        </div>

        <div class="form-row">
          <button type="submit" class="btn primary">
            Start import
          </button>
        </div>
      </form>
    {% endif %}
  </div>
{% endblock %}
