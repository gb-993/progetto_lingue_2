{% extends "base.html" %}
{% block title %}Accounts{% endblock %}
{% block breadcrumb %}Accounts{% endblock %}
{% block content %}

{% include "_toolbar_search.html" with q=request.GET.q placeholder="Search usersâ€¦" add_url="accounts_add" add_label="Add account" %}

  <div class="grid grid-2">
    <div class="card">
      <h3>Administrators</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Email</th>
            <th>Name</th>
            <th>Languages</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for u in admins %}
          <tr>
            <td>{{ u.email }}</td>
            <td>{{ u.name }} {{ u.surname }}</td>
            <td>
              {% if u.role == "admin" %}
                <span class="badge">All</span>
              {% endif %}
              <span class="muted">({{ u.m2m_languages.count }})</span>
              {% if u.m2m_languages.exists %}
                <details>
                  <summary>Dettaglio</summary>
                  <ul>
                    {% for l in u.m2m_languages.all|slice:":12" %}
                      <li>{{ l }}</li>
                    {% endfor %}
                  </ul>
                </details>
              {% endif %}
            </td>
            <td class="row-actions">
              <a class="btn" href="{% url 'accounts_edit' u.id %}">Modify</a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="muted">No admins</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="card">
      <h3>Users</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Email</th>
            <th>Name</th>
            <th>Languages</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for u in users %}
          <tr>
            <td>{{ u.email }}</td>
            <td>{{ u.name }} {{ u.surname }}</td>
            <td>
              <span class="muted">({{ u.m2m_languages.count }})</span>
              {% if u.m2m_languages.exists %}
                <details>
                  <summary>Dettaglio</summary>
                  <ul>
                    {% for l in u.m2m_languages.all|slice:":12" %}
                      <li>{{ l }}</li>
                    {% endfor %}
                  </ul>
                </details>
              {% else %}
                <span class="muted">Nessuna</span>
              {% endif %}
            </td>
            <td class="row-actions">
              <a class="btn" href="{% url 'accounts_edit' u.id %}">Modify</a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="muted">No users</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}
